<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>input/charts/PieChart.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Anim.html">Anim</a></li>
            
                <li><a href="../classes/AreaSeries.html">AreaSeries</a></li>
            
                <li><a href="../classes/AreaSplineSeries.html">AreaSplineSeries</a></li>
            
                <li><a href="../classes/Axis.html">Axis</a></li>
            
                <li><a href="../classes/AxisType.html">AxisType</a></li>
            
                <li><a href="../classes/BarSeries.html">BarSeries</a></li>
            
                <li><a href="../classes/BottomAxisLayout.html">BottomAxisLayout</a></li>
            
                <li><a href="../classes/CartesianChart.html">CartesianChart</a></li>
            
                <li><a href="../classes/CartesianSeries.html">CartesianSeries</a></li>
            
                <li><a href="../classes/CategoryAxis.html">CategoryAxis</a></li>
            
                <li><a href="../classes/Chart.html">Chart</a></li>
            
                <li><a href="../classes/ChartBase.html">ChartBase</a></li>
            
                <li><a href="../classes/ChartLegend.html">ChartLegend</a></li>
            
                <li><a href="../classes/ColumnSeries.html">ColumnSeries</a></li>
            
                <li><a href="../classes/ComboSeries.html">ComboSeries</a></li>
            
                <li><a href="../classes/ComboSplineSeries.html">ComboSplineSeries</a></li>
            
                <li><a href="../classes/CurveUtil.html">CurveUtil</a></li>
            
                <li><a href="../classes/Easing.html">Easing</a></li>
            
                <li><a href="../classes/EasingFoo.html">EasingFoo</a></li>
            
                <li><a href="../classes/EllipseGroup.html">EllipseGroup</a></li>
            
                <li><a href="../classes/Fills.html">Fills</a></li>
            
                <li><a href="../classes/Foo.Bar.html">Foo.Bar</a></li>
            
                <li><a href="../classes/Graph.html">Graph</a></li>
            
                <li><a href="../classes/Gridlines.html">Gridlines</a></li>
            
                <li><a href="../classes/GroupCircle.html">GroupCircle</a></li>
            
                <li><a href="../classes/GroupDiamond.html">GroupDiamond</a></li>
            
                <li><a href="../classes/GroupRect.html">GroupRect</a></li>
            
                <li><a href="../classes/Histogram.html">Histogram</a></li>
            
                <li><a href="../classes/HorizontalLegendLayout.html">HorizontalLegendLayout</a></li>
            
                <li><a href="../classes/JSON.html">JSON</a></li>
            
                <li><a href="../classes/LeftAxisLayout.html">LeftAxisLayout</a></li>
            
                <li><a href="../classes/Lines.html">Lines</a></li>
            
                <li><a href="../classes/LineSeries.html">LineSeries</a></li>
            
                <li><a href="../classes/Main.html">Main</a></li>
            
                <li><a href="../classes/MarkerSeries.html">MarkerSeries</a></li>
            
                <li><a href="../classes/myclass.html">myclass</a></li>
            
                <li><a href="../classes/mywidget.SubWidget.html">mywidget.SubWidget</a></li>
            
                <li><a href="../classes/mywidget.SubWidget2.html">mywidget.SubWidget2</a></li>
            
                <li><a href="../classes/mywidget.SuperWidget.html">mywidget.SuperWidget</a></li>
            
                <li><a href="../classes/NumericAxis.html">NumericAxis</a></li>
            
                <li><a href="../classes/OtherClass.html">OtherClass</a></li>
            
                <li><a href="../classes/OtherClass2.html">OtherClass2</a></li>
            
                <li><a href="../classes/P.storage.html">P.storage</a></li>
            
                <li><a href="../classes/P.storage.LocalStore.html">P.storage.LocalStore</a></li>
            
                <li><a href="../classes/P.storage.Store.html">P.storage.Store</a></li>
            
                <li><a href="../classes/PieChart.html">PieChart</a></li>
            
                <li><a href="../classes/PieSeries.html">PieSeries</a></li>
            
                <li><a href="../classes/Plots.html">Plots</a></li>
            
                <li><a href="../classes/Renderer.html">Renderer</a></li>
            
                <li><a href="../classes/RightAxisLayout.html">RightAxisLayout</a></li>
            
                <li><a href="../classes/ShapeGroup.html">ShapeGroup</a></li>
            
                <li><a href="../classes/SplineSeries.html">SplineSeries</a></li>
            
                <li><a href="../classes/StackedAreaSeries.html">StackedAreaSeries</a></li>
            
                <li><a href="../classes/StackedAreaSplineSeries.html">StackedAreaSplineSeries</a></li>
            
                <li><a href="../classes/StackedAxis.html">StackedAxis</a></li>
            
                <li><a href="../classes/StackedBarSeries.html">StackedBarSeries</a></li>
            
                <li><a href="../classes/StackedColumnSeries.html">StackedColumnSeries</a></li>
            
                <li><a href="../classes/StackedComboSeries.html">StackedComboSeries</a></li>
            
                <li><a href="../classes/StackedComboSplineSeries.html">StackedComboSplineSeries</a></li>
            
                <li><a href="../classes/StackedLineSeries.html">StackedLineSeries</a></li>
            
                <li><a href="../classes/StackedMarkerSeries.html">StackedMarkerSeries</a></li>
            
                <li><a href="../classes/StackedSplineSeries.html">StackedSplineSeries</a></li>
            
                <li><a href="../classes/StackingUtil.html">StackingUtil</a></li>
            
                <li><a href="../classes/TimeAxis.html">TimeAxis</a></li>
            
                <li><a href="../classes/TopAxisLayout.html">TopAxisLayout</a></li>
            
                <li><a href="../classes/VerticalLegendLayout.html">VerticalLegendLayout</a></li>
            
                <li><a href="../classes/YUI~dump.html">YUI~dump</a></li>
            
                <li><a href="../classes/YUI~oop.html">YUI~oop</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/anim.html">anim</a></li>
            
                <li><a href="../modules/anim-easing.html">anim-easing</a></li>
            
                <li><a href="../modules/anim-easing-foo.html">anim-easing-foo</a></li>
            
                <li><a href="../modules/charts.html">charts</a></li>
            
                <li><a href="../modules/charts-legend.html">charts-legend</a></li>
            
                <li><a href="../modules/dump.html">dump</a></li>
            
                <li><a href="../modules/ExampleModule.html">ExampleModule</a></li>
            
                <li><a href="../modules/foobar.html">foobar</a></li>
            
                <li><a href="../modules/graphics.html">graphics</a></li>
            
                <li><a href="../modules/json.html">json</a></li>
            
                <li><a href="../modules/json-parse.html">json-parse</a></li>
            
                <li><a href="../modules/json-stringify.html">json-stringify</a></li>
            
                <li><a href="../modules/myapp_views_index.html">myapp/views/index</a></li>
            
                <li><a href="../modules/mymodule.html">mymodule</a></li>
            
                <li><a href="../modules/mysubmodule.html">mysubmodule</a></li>
            
                <li><a href="../modules/oop.html">oop</a></li>
            
                <li><a href="../modules/P.storage.html">P.storage</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: input/charts/PieChart.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * The PieChart class creates a pie chart
 *
 * @module charts
 * @class PieChart
 * @extends ChartBase
 * @constructor
 */
Y.PieChart = Y.Base.create(&quot;pieChart&quot;, Y.Widget, [Y.ChartBase], {
    /**
     * Calculates and returns a &#x60;seriesCollection&#x60;.
     *
     * @method _getSeriesCollection
     * @return Array
     * @private
     */
    _getSeriesCollection: function()
    {
        if(this._seriesCollection)
        {
            return this._seriesCollection;
        }
        var axes = this.get(&quot;axes&quot;),
            sc = [], 
            seriesKeys,
            i = 0,
            l,
            type = this.get(&quot;type&quot;),
            key,
            catAxis = &quot;categoryAxis&quot;,
            catKey = &quot;categoryKey&quot;,
            valAxis = &quot;valueAxis&quot;,
            seriesKey = &quot;valueKey&quot;;
        if(axes)
        {
            seriesKeys = axes.values.get(&quot;keyCollection&quot;);
            key = axes.category.get(&quot;keyCollection&quot;)[0];
            l = seriesKeys.length;
            for(; i &lt; l; ++i)
            {
                sc[i] = {type:type};
                sc[i][catAxis] = &quot;category&quot;;
                sc[i][valAxis] = &quot;values&quot;;
                sc[i][catKey] = key;
                sc[i][seriesKey] = seriesKeys[i];
            }
        }
        this._seriesCollection = sc;
        return sc;
    },

    /**
     * Creates &#x60;Axis&#x60; instances.
     *
     * @method _parseAxes
     * @param {Object} val Object containing &#x60;Axis&#x60; instances or objects in which to construct &#x60;Axis&#x60; instances.
     * @return Object
     * @private
     */
    _parseAxes: function(hash)
    {
        if(!this._axes)
        {
            this._axes = {};
        }
        var i, pos, axis, dh, config, axisClass,
            type = this.get(&quot;type&quot;),
            w = this.get(&quot;width&quot;),
            h = this.get(&quot;height&quot;),
            node = Y.Node.one(this._parentNode);
        if(!w)
        {
            this.set(&quot;width&quot;, node.get(&quot;offsetWidth&quot;));
            w = this.get(&quot;width&quot;);
        }
        if(!h)
        {
            this.set(&quot;height&quot;, node.get(&quot;offsetHeight&quot;));
            h = this.get(&quot;height&quot;);
        }
        for(i in hash)
        {
            if(hash.hasOwnProperty(i))
            {
                dh = hash[i];
                pos = type == &quot;pie&quot; ? &quot;none&quot; : dh.position;
                axisClass = this._getAxisClass(dh.type);
                config = {dataProvider:this.get(&quot;dataProvider&quot;)};
                if(dh.hasOwnProperty(&quot;roundingUnit&quot;))
                {
                    config.roundingUnit = dh.roundingUnit;
                }
                config.keys = dh.keys;
                config.width = w;
                config.height = h;
                config.position = pos;
                config.styles = dh.styles;
                axis = new axisClass(config);
                axis.on(&quot;axisRendered&quot;, Y.bind(this._itemRendered, this));
                this._axes[i] = axis;
            }
        }
    },

    /**
     * Adds axes to the chart.
     *
     * @method _addAxes
     * @private
     */
    _addAxes: function()
    {
        var axes = this.get(&quot;axes&quot;),
            i, 
            axis, 
            p;
        if(!axes)
        {
            this.set(&quot;axes&quot;, this._getDefaultAxes());
            axes = this.get(&quot;axes&quot;);
        }
        if(!this._axesCollection)
        {   
            this._axesCollection = [];
        }
        for(i in axes)
        {
            if(axes.hasOwnProperty(i))
            {
                axis = axes[i];
                p = axis.get(&quot;position&quot;);
                if(!this.get(p + &quot;AxesCollection&quot;))
                {
                    this.set(p + &quot;AxesCollection&quot;, [axis]);
                }
                else
                {
                    this.get(p + &quot;AxesCollection&quot;).push(axis);
                }
                this._axesCollection.push(axis);
            }
        }
    },

    /**
     * Renders the Graph.
     *
     * @method _addSeries
     * @private
     */
    _addSeries: function()
    {
        var graph = this.get(&quot;graph&quot;),
            seriesCollection = this.get(&quot;seriesCollection&quot;);
        this._parseSeriesAxes(seriesCollection);
        graph.set(&quot;showBackground&quot;, false);
        graph.set(&quot;width&quot;, this.get(&quot;width&quot;));
        graph.set(&quot;height&quot;, this.get(&quot;height&quot;));
        graph.set(&quot;seriesCollection&quot;, seriesCollection);
        this._seriesCollection = graph.get(&quot;seriesCollection&quot;);
        graph.render(this.get(&quot;contentBox&quot;));
    },

    /**
     * Parse and sets the axes for the chart.
     *
     * @method _parseSeriesAxes
     * @param {Array} c A collection &#x60;PieSeries&#x60; instance.
     * @private
     */
    _parseSeriesAxes: function(c)
    {
        var i = 0, 
            len = c.length, 
            s,
            axes = this.get(&quot;axes&quot;),
            axis;
        for(; i &lt; len; ++i)
        {
            s = c[i];
            if(s)
            {
                //If series is an actual series instance, 
                //replace axes attribute string ids with axes
                if(s instanceof Y.PieSeries)
                {
                    axis = s.get(&quot;categoryAxis&quot;);
                    if(axis &amp;&amp; !(axis instanceof Y.Axis))
                    {
                        s.set(&quot;categoryAxis&quot;, axes[axis]);
                    }
                    axis = s.get(&quot;valueAxis&quot;);
                    if(axis &amp;&amp; !(axis instanceof Y.Axis))
                    {
                        s.set(&quot;valueAxis&quot;, axes[axis]);
                    }
                    continue;
                }
                s.categoryAxis = axes.category;
                s.valueAxis = axes.values;
                if(!s.type)
                {
                    s.type = this.get(&quot;type&quot;);
                }
            }
        }
    },

    /**
     * Generates and returns a key-indexed object containing &#x60;Axis&#x60; instances or objects used to create &#x60;Axis&#x60; instances.
     *
     * @method _getDefaultAxes
     * @return Object
     * @private
     */
    _getDefaultAxes: function()
    {
        var catKey = this.get(&quot;categoryKey&quot;),
            seriesKeys = this.get(&quot;seriesKeys&quot;) || [], 
            seriesAxis = &quot;numeric&quot;,
            i, 
            dv = this.get(&quot;dataProvider&quot;)[0];
        if(seriesKeys.length &lt; 1)
        {
            for(i in dv)
            {
                if(i != catKey)
                {
                    seriesKeys.push(i);
                }
            }
            if(seriesKeys.length &gt; 0)
            {
                this.set(&quot;seriesKeys&quot;, seriesKeys);
            }
        }
        return {
            values:{
                keys:seriesKeys,
                type:seriesAxis
            },
            category:{
                keys:[catKey],
                type:this.get(&quot;categoryType&quot;)
            }
        };
    },
        
    /**
     * Returns an object literal containing a categoryItem and a valueItem for a given series index.
     *
     * @method getSeriesItem
     * @param series Reference to a series.
     * @param index Index of the specified item within a series.
     * @return Object
     */
    getSeriesItems: function(series, index)
    {
        var categoryItem = {
                axis: series.get(&quot;categoryAxis&quot;),
                key: series.get(&quot;categoryKey&quot;),
                displayName: series.get(&quot;categoryDisplayName&quot;)
            },
            valueItem = {
                axis: series.get(&quot;valueAxis&quot;),
                key: series.get(&quot;valueKey&quot;),
                displayName: series.get(&quot;valueDisplayName&quot;)
            };
        categoryItem.value = categoryItem.axis.getKeyValueAt(categoryItem.key, index);
        valueItem.value = valueItem.axis.getKeyValueAt(valueItem.key, index);
        return {category:categoryItem, value:valueItem};
    },

    /**
     * Handler for sizeChanged event.
     *
     * @method _sizeChanged
     * @param {Object} e Event object.
     * @private
     */
    _sizeChanged: function(e)
    {
        this._redraw();
    },

    /**
     * Redraws the chart instance.
     *
     * @method _redraw
     * @private
     */
    _redraw: function()
    {
        var graph = this.get(&quot;graph&quot;),
            w = this.get(&quot;width&quot;),
            h = this.get(&quot;height&quot;),
            dimension;
        if(graph)
        {
            dimension = Math.min(w, h);
            graph.set(&quot;width&quot;, dimension);
            graph.set(&quot;height&quot;, dimension);
        }
    },
    
    /**
     * Formats tooltip text for a pie chart.
     *
     * @method _tooltipLabelFunction
     * @param {Object} categoryItem An object containing the following:
     *  &lt;dl&gt;
     *      &lt;dt&gt;axis&lt;/dt&gt;&lt;dd&gt;The axis to which the category is bound.&lt;/dd&gt;
     *      &lt;dt&gt;displayName&lt;/dt&gt;&lt;dd&gt;The display name set to the category (defaults to key if not provided)&lt;/dd&gt;
     *      &lt;dt&gt;key&lt;/dt&gt;&lt;dd&gt;The key of the category.&lt;/dd&gt;
     *      &lt;dt&gt;value&lt;/dt&gt;&lt;dd&gt;The value of the category&lt;/dd&gt;
     *  &lt;/dl&gt;
     * @param {Object} valueItem An object containing the following:
     *  &lt;dl&gt;
     *      &lt;dt&gt;axis&lt;/dt&gt;&lt;dd&gt;The axis to which the item&#x27;s series is bound.&lt;/dd&gt;
     *      &lt;dt&gt;displayName&lt;/dt&gt;&lt;dd&gt;The display name of the series. (defaults to key if not provided)&lt;/dd&gt;
     *      &lt;dt&gt;key&lt;/dt&gt;&lt;dd&gt;The key for the series.&lt;/dd&gt;
     *      &lt;dt&gt;value&lt;/dt&gt;&lt;dd&gt;The value for the series item.&lt;/dd&gt; 
     *  &lt;/dl&gt;
     * @param {Number} itemIndex The index of the item within the series.
     * @param {CartesianSeries} series The &#x60;PieSeries&#x60; instance of the item.
     * @param {Number} seriesIndex The index of the series in the &#x60;seriesCollection&#x60;.
     * @return {HTML}
     * @private
     */
    _tooltipLabelFunction: function(categoryItem, valueItem, itemIndex, series, seriesIndex)
    {
        var msg = DOCUMENT.createElement(&quot;div&quot;),
            total = series.getTotalValues(),
            pct = Math.round((valueItem.value / total) * 10000)/100;
        msg.appendChild(DOCUMENT.createTextNode(categoryItem.displayName +
        &quot;: &quot; + categoryItem.axis.get(&quot;labelFunction&quot;).apply(this, [categoryItem.value, categoryItem.axis.get(&quot;labelFormat&quot;)]))); 
        msg.appendChild(DOCUMENT.createElement(&quot;br&quot;));
        msg.appendChild(DOCUMENT.createTextNode(valueItem.displayName + 
        &quot;: &quot; + valueItem.axis.get(&quot;labelFunction&quot;).apply(this, [valueItem.value, valueItem.axis.get(&quot;labelFormat&quot;)])));
        msg.appendChild(DOCUMENT.createElement(&quot;br&quot;));
        msg.appendChild(DOCUMENT.createTextNode(pct + &quot;%&quot;)); 
        return msg; 
    },

    /**
     * Returns the appropriate message based on the key press.
     *
     * @method _getAriaMessage
     * @param {Number} key The keycode that was pressed.
     * @return String
     */
    _getAriaMessage: function(key)
    {
        var msg = &quot;&quot;,
            categoryItem,
            items,
            series,
            valueItem,
            seriesIndex = 0,
            itemIndex = this._itemIndex,
            seriesCollection = this.get(&quot;seriesCollection&quot;),
            len,
            total,
            pct,
            markers;
        series = this.getSeries(parseInt(seriesIndex, 10));
        markers = series.get(&quot;markers&quot;);
        len = markers &amp;&amp; markers.length ? markers.length : 0;
        if(key === 37)
        {
            itemIndex = itemIndex &gt; 0 ? itemIndex - 1 : len - 1;
        }
        else if(key === 39)
        {
            itemIndex = itemIndex &gt;= len - 1 ? 0 : itemIndex + 1;
        }
        this._itemIndex = itemIndex;
        items = this.getSeriesItems(series, itemIndex);
        categoryItem = items.category;
        valueItem = items.value;
        total = series.getTotalValues();
        pct = Math.round((valueItem.value / total) * 10000)/100;
        if(categoryItem &amp;&amp; valueItem)
        {
            msg += categoryItem.displayName + &quot;: &quot; + categoryItem.axis.formatLabel.apply(this, [categoryItem.value, categoryItem.axis.get(&quot;labelFormat&quot;)]) + &quot;, &quot;;
            msg += valueItem.displayName + &quot;: &quot; + valueItem.axis.formatLabel.apply(this, [valueItem.value, valueItem.axis.get(&quot;labelFormat&quot;)]) + &quot;, &quot;; 
            msg += &quot;Percent of total &quot; + valueItem.displayName + &quot;: &quot; + pct + &quot;%,&quot;; 
        }
        else
        {
            msg += &quot;No data available,&quot;;
        }
        msg += (itemIndex + 1) + &quot; of &quot; + len + &quot;. &quot;;
        return msg;
    }
}, {
    ATTRS: {
        /**
         * Sets the aria description for the chart.
         *
         * @attribute ariaDescription
         * @type String
         */
        ariaDescription: {
            value: &quot;Use the left and right keys to navigate through items.&quot;,

            setter: function(val)
            {
                if(this._description)
                {
                    this._description.setContent(&quot;&quot;);
                    this._description.appendChild(DOCUMENT.createTextNode(val));
                }
                return val;
            }
        },
        
        /**
         * Axes to appear in the chart. 
         *
         * @attribute axes
         * @type Object
         */
        axes: {
            getter: function()
            {
                return this._axes;
            },

            setter: function(val)
            {
                this._parseAxes(val);
            }
        },

        /**
         * Collection of series to appear on the chart. This can be an array of Series instances or object literals
         * used to describe a Series instance.
         *
         * @attribute seriesCollection
         * @type Array
         */
        seriesCollection: {
            getter: function()
            {
                return this._getSeriesCollection();
            },
            
            setter: function(val)
            {
                return this._setSeriesCollection(val);
            }
        },
        
        /**
         * Type of chart when there is no series collection specified.
         *
         * @attribute type
         * @type String 
         */
        type: {
            value: &quot;pie&quot;
        }
    }
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
